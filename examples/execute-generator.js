/**
 * Script direto para executar o AutoGeneratorDDD
 * Execute com: node examples/execute-generator.js
 */

const { execSync } = require('child_process');

console.log('üéØ Executando AutoGeneratorDDD via Node.js');
console.log('==========================================\n');

// Verificar se os arquivos existem
const fs = require('fs');
const path = require('path');

const schemaPath = path.join(__dirname, 'user.schema.ts');
const generatorPath = path.join(__dirname, '..', 'src', 'auto-generator-ddd.js');

console.log('üìÇ Verificando arquivos...');
console.log(`üìÑ Schema: ${fs.existsSync(schemaPath) ? '‚úÖ' : '‚ùå'} ${schemaPath}`);
console.log(`üèóÔ∏è  Generator: ${fs.existsSync(generatorPath.replace('.js', '.ts')) ? '‚úÖ' : '‚ùå'} ${generatorPath}\n`);

try {
  console.log('üöÄ Iniciando gera√ß√£o DDD...\n');

  // Criar arquivo tempor√°rio para execu√ß√£o
  const tempScript = `
    import { autoGenerateDDDFromZodSchemas } from './src/auto-generator-ddd.js';

    console.log('üéØ AutoGeneratorDDD iniciado...');

    await autoGenerateDDDFromZodSchemas({
      modulesPath: 'examples',
      domainPath: 'src/domain',
      boundedContext: 'user-example',
      verbose: true,
      force: true,
      dryRun: true
    });

    console.log('‚úÖ Gera√ß√£o conclu√≠da!');
  `;

  const tempFile = path.join(__dirname, 'temp-generator.mjs');
  fs.writeFileSync(tempFile, tempScript);

  // Executar com node
  execSync(`node --input-type=module ${tempFile}`, {
    stdio: 'inherit',
    cwd: path.join(__dirname, '..')
  });

  // Limpar arquivo tempor√°rio
  fs.unlinkSync(tempFile);

} catch (error) {
  console.error('‚ùå Erro na execu√ß√£o:', error.message);

  console.log('\nüîß SOLU√á√ïES ALTERNATIVAS:');
  console.log('1. Execute manualmente no browser console:');
  console.log('   - Abra examples/manual-execution.ts');
  console.log('   - Copie o c√≥digo e execute');

  console.log('\n2. Use o script de teste:');
  console.log('   - Abra examples/test-ddd-generator.ts');
  console.log('   - Execute as fun√ß√µes uma por uma');

  console.log('\n3. Verifique se TypeScript compila:');
  console.log('   npx tsc --noEmit src/auto-generator-ddd.ts');
}
