/**
 * Exemplo de uso do AutoGeneratorDDD
 * Demonstra como gerar arquitetura DDD completa baseada em schemas Zod
 */

import { autoGenerateDDDFromZodSchemas, AutoGeneratorDDD } from '../src/auto-generator-ddd.js';

/**
 * Exemplo 1: Usando a fun√ß√£o utilit√°ria simples
 */
async function exemploSimples() {
  console.log('üöÄ Exemplo 1: Gera√ß√£o DDD simples');

  try {
    await autoGenerateDDDFromZodSchemas({
      modulesPath: 'src/modules',
      domainPath: 'src/domain',
      boundedContext: 'user-management',
      verbose: true,
      force: false,
      dryRun: false // Mude para false para gerar arquivos reais
    });

    console.log('‚úÖ Gera√ß√£o DDD conclu√≠da!');
  } catch (error) {
    console.error('‚ùå Erro na gera√ß√£o DDD:', error);
  }
}

/**
 * Exemplo 2: Usando a classe diretamente com mais controle
 */
async function exemploAvancado() {
  console.log('üöÄ Exemplo 2: Gera√ß√£o DDD avan√ßada com classe');

  const generator = new AutoGeneratorDDD({
    modulesPath: 'src/modules',
    domainPath: 'src/domain',
    boundedContext: 'user-management',
    verbose: true,
    force: false,
    dryRun: false // Mude para false para gerar arquivos reais
  });

  try {
    await generator.generate();
    console.log('‚úÖ Gera√ß√£o DDD avan√ßada conclu√≠da!');

    // Listar m√≥dulos gerados
    const modulosGerados = AutoGeneratorDDD.listGeneratedDDDModules('src/modules');
    console.log(`üì¶ M√≥dulos DDD gerados: ${modulosGerados.join(', ')}`);

  } catch (error) {
    console.error('‚ùå Erro na gera√ß√£o DDD avan√ßada:', error);
  }
}

/**
 * Exemplo 3: Limpeza de m√≥dulos gerados (para desenvolvimento)
 */
async function exemploLimpeza() {
  console.log('üßπ Exemplo 3: Limpando m√≥dulos DDD gerados');

  // Listar antes da limpeza
  const antes = AutoGeneratorDDD.listGeneratedDDDModules('src/modules');
  console.log(`üì¶ M√≥dulos antes da limpeza: ${antes.join(', ')}`);

  // Limpar (dry run por seguran√ßa)
  AutoGeneratorDDD.cleanGeneratedDDDModules('src/modules', true);

  // Listar depois da limpeza
  const depois = AutoGeneratorDDD.listGeneratedDDDModules('src/modules');
  console.log(`üì¶ M√≥dulos depois da limpeza: ${depois.join(', ')}`);
}

/**
 * Exemplo 4: Gera√ß√£o com m√∫ltiplos bounded contexts
 */
async function exemploMultiplosContextos() {
  console.log('üöÄ Exemplo 4: Gera√ß√£o com m√∫ltiplos bounded contexts');

  const contextos = [
    { name: 'user-management', path: 'src/modules/users' },
    { name: 'product-catalog', path: 'src/modules/products' },
    { name: 'order-processing', path: 'src/modules/orders' }
  ];

  for (const contexto of contextos) {
    console.log(`üèóÔ∏è  Gerando bounded context: ${contexto.name}`);

    const generator = new AutoGeneratorDDD({
      modulesPath: contexto.path,
      domainPath: `src/domain/${contexto.name}`,
      boundedContext: contexto.name,
      verbose: false, // Menos verbose para m√∫ltiplos
      force: false,
      dryRun: false
    });

    try {
      await generator.generate();
      console.log(`‚úÖ ${contexto.name} gerado com sucesso!`);
    } catch (error) {
      console.error(`‚ùå Erro ao gerar ${contexto.name}:`, error);
    }
  }
}

/**
 * Exemplo 5: Configura√ß√£o personalizada por ambiente
 */
async function exemploConfiguracaoAmbiente() {
  console.log('üöÄ Exemplo 5: Configura√ß√£o personalizada por ambiente');

  // Configura√ß√µes diferentes por ambiente
  const configs = {
    development: {
      verbose: true,
      dryRun: false,
      force: true
    },
    production: {
      verbose: false,
      dryRun: false,
      force: false
    }
  };

  const ambiente = process.env.NODE_ENV || 'development';
  const config = configs[ambiente as keyof typeof configs];

  console.log(`üåç Ambiente: ${ambiente}`);
  console.log(`‚öôÔ∏è  Configura√ß√£o:`, config);

  const generator = new AutoGeneratorDDD({
    modulesPath: 'src/modules',
    domainPath: 'src/domain',
    boundedContext: 'app',
    ...config
  });

  try {
    await generator.generate();
    console.log(`‚úÖ Gera√ß√£o DDD para ${ambiente} conclu√≠da!`);
  } catch (error) {
    console.error(`‚ùå Erro na gera√ß√£o para ${ambiente}:`, error);
  }
}

/**
 * Fun√ß√£o principal - execute os exemplos desejados
 */
async function main() {
  console.log('üéØ Teste do AutoGeneratorDDD');
  console.log('================================\n');

  // Execute os exemplos (descomente os que quiser testar)

  // Exemplo b√°sico
  await exemploSimples();
  console.log('\n');

  // Exemplo avan√ßado
  await exemploAvancado();
  console.log('\n');

  // Exemplo de limpeza
  await exemploLimpeza();
  console.log('\n');

  // Exemplo m√∫ltiplos contextos
  // await exemploMultiplosContextos();
  // console.log('\n');

  // Exemplo configura√ß√£o ambiente
  // await exemploConfiguracaoAmbiente();
  // console.log('\n');

  console.log('üéâ Todos os exemplos executados!');
}

// Executar se chamado diretamente
// if (require.main === module) {
//   main().catch(console.error);
// }

export {
  exemploSimples,
  exemploAvancado,
  exemploLimpeza,
  exemploMultiplosContextos,
  exemploConfiguracaoAmbiente
};
